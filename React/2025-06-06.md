# ğŸ“ ä»Šæ—¥ã®å­¦ã³ï¼ˆTIL: Today I Learnedï¼‰2025-06-06

---

## ğŸš« NGä¾‹ï¼šReactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã® `document.querySelector` ã®ä½¿ç”¨

```jsx
export const BreedsSelect = ({ breeds, setSelectedBreed }) => {
  const selectElement = document.querySelector('#select')
  function handleBreedChange(){
    setSelectedBreed(selectElement.value);
  }

  return (
    <select id="select" onChange={handleBreedChange}>
      {breeds.map((breed) => (
        <option key={breed} value={breed}>
          {breed}
        </option>
      ))}
    </select>
  );
};
```

### ğŸ” ç†ç”±

- Reactã§ã¯DOMã‚’ç›´æ¥æ“ä½œã™ã‚‹ã®ã¯è¨­è¨ˆæ€æƒ³ã«åã™ã‚‹
- `document.querySelector` ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–¢æ•°å†…ã§å‘¼ã¶ã¨ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰ã« `null` ã‚’è¿”ã™å¯èƒ½æ€§ãŒã‚ã‚Šã€çŠ¶æ…‹ç®¡ç†ã‚„ã‚¤ãƒ™ãƒ³ãƒˆãŒæ­£ã—ãå‹•ã‹ãªããªã‚‹

### âœ… æ”¹å–„ä¾‹ï¼šã‚¤ãƒ™ãƒ³ãƒˆã® `event.target` ã‚’åˆ©ç”¨ã™ã‚‹

```jsx
export const BreedsSelect = ({ breeds, setSelectedBreed }) => {
  function handleBreedChange(event) {
    setSelectedBreed(event.target.value);
  }

  return (
    <select id="select" onChange={handleBreedChange}>
      {breeds.map((breed) => (
        <option key={breed} value={breed}>
          {breed}
        </option>
      ))}
    </select>
  );
};
```

`event` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å€¤ã‚’å–å¾—ã—ã€ç›´æ¥Reactã®çŠ¶æ…‹ç®¡ç†ã¨é€£æºã™ã‚‹ã®ãŒæ­£ã—ã„ã€‚

---

## ğŸš« NGä¾‹ï¼šuseEffect ã‚’ãƒ«ãƒ¼ãƒ—å†…ã§å‘¼ã¶ã®ã¯NG

```jsx
function displayDogs(){
  const limit=12;
  for (let index = 0; index < limit; index++) {
    useEffect(() => {
      fetch(`https://dog.ceo/api/breed/${selectedBreed}/images/random`)
      .then(res => res.json())
      .then(data => setBreeds(data));
    }, []);
  }
}
```

### âŒ å•é¡Œç‚¹

- Reactã®ãƒ•ãƒƒã‚¯ã¯æ¡ä»¶åˆ†å²ã‚„ãƒ«ãƒ¼ãƒ—å†…ã§å‘¼ã‚“ã§ã¯ã„ã‘ãªã„
- ãƒ•ãƒƒã‚¯ã®å‘¼ã³å‡ºã—é †åºãŒå¤‰ã‚ã‚‹ã¨ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚„çŠ¶æ…‹ç®¡ç†ãŒç ´ç¶»ã™ã‚‹

---

## âš ï¸ é‡è¦ï¼šnullãƒã‚§ãƒƒã‚¯ã‚’å¿˜ã‚Œãªã„

```jsx
useEffect(() => {
  if (!selectedBreed) return; // nullãƒã‚§ãƒƒã‚¯
  fetch(`https://dog.ceo/api/breed/${selectedBreed}/images/random/${dogImagesLimit}`)
    .then(res => res.json())
    .then(data => setdogImages(data.message));
}, [selectedBreed]);
```

`selectedBreed` ãŒ `null` ã‚„ `undefined` ã®å ´åˆã‚’è€ƒæ…®ã—ã¦å‡¦ç†ã‚’ä¸­æ–­ã™ã‚‹ã®ãŒå®‰å…¨ã€‚

---

## ğŸ¶ DogListContainer ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç¾çŠ¶ã¨èª²é¡Œ

```jsx
import { useEffect, useState } from 'react';
import BreedsSelect from './BreedsSelect';

export const DogListContainer = () => {
  const [breeds, setBreeds] = useState(null);
  const [selectedBreed, setSelectedBreed] = useState(null);
  const [dogImages, setdogImages] = useState([]);
  const dogImagesLimit = 12;

  useEffect(() => {
    fetch('https://dog.ceo/api/breeds/list/all')
      .then(res => res.json())
      .then(data => setBreeds(data));
  }, []);

  const breedKeys = breeds?.message ? Object.keys(breeds.message) : [];

  function displayDogs() {
    console.log(dogImages);
  }

  return (
    <>
      <BreedsSelect breeds={breedKeys} setSelectedBreed={setSelectedBreed} />
      <button onClick={displayDogs}>è¡¨ç¤º</button>
      {dogImages.map((dogImage) => (
        <img src={dogImage} />
      ))}
    </>
  );
}

export default DogListContainer;
```

### ğŸ” å•é¡Œç‚¹

- ç”»åƒå–å¾—ã¯ `selectedBreed` ãŒå¤‰ã‚ã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•çš„ã«ç™ºç«ã™ã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ãªã„
- `displayDogs` é–¢æ•°ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹ã ã‘ã§ã€ç”»åƒè¡¨ç¤ºã¨ã¯ç„¡é–¢ä¿‚
- å®Ÿéš›ã¯ç”»åƒã¯ã™ã§ã« state ã®å¤‰æ›´ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã¯ä¸è¦ãªUX

---

## ğŸ›  æ”¹å–„æ¡ˆï¼šãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ç”»åƒå–å¾—ã‚’æ˜ç¤ºçš„ã«è¡Œã†å®Ÿè£…ä¾‹

```jsx
import { useEffect, useState } from 'react';
import BreedsSelect from './BreedsSelect';

export const DogListContainer = () => {
  const [breeds, setBreeds] = useState(null);
  const [selectedBreed, setSelectedBreed] = useState(null);
  const [dogImages, setdogImages] = useState([]);
  const dogImagesLimit = 12;

  useEffect(() => {
    fetch('https://dog.ceo/api/breeds/list/all')
      .then(res => res.json())
      .then(data => setBreeds(data));
  }, []);

  const breedKeys = breeds?.message ? Object.keys(breeds.message) : [];

  function displayDogs() {
    if (!selectedBreed) return; // nullãƒã‚§ãƒƒã‚¯
    fetch(`https://dog.ceo/api/breed/${selectedBreed}/images/random/${dogImagesLimit}`)
      .then(res => res.json())
      .then(data => setdogImages(data.message));
  }

  return (
    <>
      <BreedsSelect breeds={breedKeys} setSelectedBreed={setSelectedBreed} />
      <button onClick={displayDogs}>è¡¨ç¤º</button>
      {dogImages.map((dogImage) => (
        <img key={dogImage} src={dogImage} alt="dog" />
      ))}
    </>
  );
}

export default DogListContainer;
```

- `displayDogs` é–¢æ•°ã‚’ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å‘¼ã³ã€æ˜ç¤ºçš„ã«ç”»åƒå–å¾—ã‚’è¡Œã†ä»•æ§˜ã«å¤‰æ›´
- `selectedBreed` ã® nullãƒã‚§ãƒƒã‚¯ã‚’å¿˜ã‚Œãªã„
- `<img>`ã‚¿ã‚°ã« `key` ã¨ `alt` ã‚’è¿½åŠ ã—ã¦ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š

---

## ğŸ“š ã¾ã¨ã‚

1. **Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§DOMæ“ä½œã‚’ç›´æ¥ã—ãªã„ã€‚ã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ´»ç”¨ã™ã‚‹**
2. **Reactãƒ•ãƒƒã‚¯ï¼ˆuseEffect, useStateãªã©ï¼‰ã¯æ¡ä»¶åˆ†å²ã‚„ãƒ«ãƒ¼ãƒ—ã®ä¸­ã§å‘¼ã°ãªã„**
3. **éåŒæœŸå‡¦ç†ã®å‰ã«nullãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦å®‰å…¨ã«**
4. **UIã®è¡¨ç¤ºã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã®è¨­è¨ˆã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœŸå¾…ã«æ²¿ã†å½¢ã§å®Ÿè£…ã™ã‚‹**
